<%- include('partials/header'); -%>

<div class="video-container">
  <!-- Video Player -->
  <video id="video-player" controls>
    <source src="" type="video/mp4" />
    Your browser does not support the video tag.
  </video>

  <div class="align">
    <!-- Previous Button -->
    <button id="previous-btn">Previous</button>

    <!-- Next Button -->
    <button id="next-btn">Next</button>
  </div>

  <!-- Share Button -->
  <button id="share-btn">Share</button>

  <!-- Other Control Buttons -->
  <!-- Add your custom control buttons here -->
</div>

<%- include('partials/footer'); -%>

<script>
    const videoPlayer = document.getElementById("video-player");
    const previousBtn = document.getElementById("previous-btn");
    const nextBtn = document.getElementById("next-btn");
    const shareBtn = document.getElementById("share-btn");
  
    let videos = []; // Array to store fetched videos
    let currentVideoIndex = 0;
  
    const loadCurrentVideo = async () => {
      // Get the current video ID
      const videoId = videos[currentVideoIndex]._id;
  
      try {
        // Fetch the URL of the current video
        const response = await fetch(`/videos/${videoId}/url`);
        const data = await response.json();
        const videoUrl = data.videoUrl;
  
        // Set the video source
        videoPlayer.src = videoUrl;
      } catch (error) {
        console.error("Error loading video:", error.message);
      }
    };
  
    const handlePreviousButtonClick = () => {
      if (currentVideoIndex > 0) {
        currentVideoIndex--;
        loadCurrentVideo();
      }
    };
  
    const handleNextButtonClick = () => {
      if (currentVideoIndex < videos.length - 1) {
        currentVideoIndex++;
        loadCurrentVideo();
      }
    };
  
    const handleShareButtonClick = () => {
      // Implement share functionality if needed
    };
  
    previousBtn.addEventListener("click", handlePreviousButtonClick);
    nextBtn.addEventListener("click", handleNextButtonClick);
    shareBtn.addEventListener("click", handleShareButtonClick);
  
    const fetchVideos = async () => {
      try {
        const response = await fetch("/navigate-videos");
        const data = await response.json();
        videos = data.videos;
        loadCurrentVideo();
      } catch (error) {
        console.error("Error fetching videos:", error.message);
      }
    };
  
    fetchVideos();
  </script>  